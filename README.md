# Postgresql + PgAdmin на базе docker-compose

## Требования:

- docker
- docker-compose

## Команды:

- поднять контейнер: `$ docker-compose --compatibility up -d`
- остановить запущенный контейнер: `$ docker-compose --compatibility stop`
- запустить остановленный контейнер: `$ docker-compose --compatibility start`
- остановить и удалить контейнер и сеть: `$ docker-compose --compatibility down`
- удалить директорию 'pgdata': `$ sudo rm -R pgdata`

## Коннект к Postgres:

- **URL:** `localhost:5432`
- **Username:** `postgres`
- **Password:** `changeme`

## Переменные окружения:

- `POSTGRES_DB` по умолчанию — **postgres**
- `POSTGRES_USER` по умолчанию — **postgres**
- `POSTGRES_PASSWORD` по умолчанию — **changeme**

## Первичная инициализация структуры БД:

- При выполнении команды `up` будут выполнены все скрипты из директории `initdb`.
- Любые `*.sql` или `*.sh` файлы в этом каталоге будут рассматриваться как скрипты для инициализации БД.
- Если БД уже была проинициализирована ранее, то никакие изменения к ней применяться не будут.
- Если в каталоге присутствует несколько файлов, то они будут отсортированы по имени с использованием текущей локали (по умолчанию en_US.utf8).
- Если инициализация не нужна, достаточно очистить каталок `initdb` перед выполнением команды `up`.

## Размещение данных БД:

- При выполнении команды `up` рядом со скриптом создайтся директория `pgdata`, где будут располагаться файлы БД.
- При новой инициализации БД директорию `pgdata` необходимо удалить: `$ sudo rm -R pgdata`

## Параметны контейнера:

- В блоке кода `command:` заданы парметры БД, влияющие на производительность.
- Для использования параметров БД по умолчанию достаточно удалить блок кода `command:`.

<!-- -->

- В блоке кода `healthcheck:` задана периодическая проверка состояния/работоспособности БД и перезапуск контейнера при неполадках.
- Для отмены такой проверки достаточно удалить блок кода `healthcheck:`.

<!-- -->

- В блоке кода `deploy:` заданы ограничения ресурсов для контейнера с БД.
- Для отмены ограничений достаточно удалить блок кода `deploy:`.
